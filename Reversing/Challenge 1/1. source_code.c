#include "out.h"

int _init(EVP_PKEY_CTX *ctx)
{
  int iVar1;
  iVar1 = __gmon_start__();
  return iVar1;
}

void FUN_00101020(void)
{
  (*(code *)(undefined *)0x0)();
  return;
}

int my_puts(char *__s)
{
  int iVar1;
  iVar1 = puts(__s);
  return iVar1;
}

size_t my_strlen(char *__s)
{
  size_t sVar1;
  sVar1 = strlen(__s);
  return sVar1;
}

void __stack_chk_fail(void)
{
  __stack_chk_fail();
}

int my_printf(char *__format, ...)
{
  int iVar1;
  va_list args;
  va_start(args, __format);
  iVar1 = vprintf(__format, args);
  va_end(args);
  return iVar1;
}

void __cxa_finalize(void)
{
  __cxa_finalize();
  return;
}

void processEntry(undefined8 param_1, undefined8 param_2)
{
  undefined auStack_8[8];
  __libc_start_main(main, param_2, &stack0x00000008, __libc_csu_init, __libc_csu_fini, param_1, auStack_8);
  while (1) {
    // Add your code here, if needed
  }
}

void FUN_001010b0(void)
{
  return;
}

void FUN_001010e0(void)
{
  return;
}

void _FINI_0(void)
{
  if (__TMC_END__ != '\0') {
    return;
  }
  __cxa_finalize(__dso_handle);
  FUN_001010b0();
  __TMC_END__ = 1;
  return;
}

void _INIT_0(void)
{
  return;
}

undefined8 main(int param_1, long param_2)
{
  undefined8 uVar1;
  size_t sVar2;
  long in_FS_OFFSET;
  int local_98;
  int local_94;
  int local_88[24];
  byte abStack_28[24];
  long local_10;

  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  if (param_1 == 1)
  {
    my_puts("Usage: ./crackme FLAG");
    uVar1 = 1;
  }
  else
  {
    sVar2 = my_strlen(*(char **)(param_2 + 8));
    if (sVar2 == 0x15)
    {
      for (local_98 = 0; local_98 < 0x15; local_98 = local_98 + 1)
      {
        abStack_28[local_98] = "sup3r_s3cr3t_k3y_1337"[local_98] - 0x22;
      }
      local_88[0] = 0x37;
      local_88[1] = 0x3f;
      local_88[2] = 0x2f;
      local_88[3] = 0x76;
      local_88[4] = 0x2b;
      local_88[5] = 0x62;
      local_88[6] = 0x28;
      local_88[7] = 0x21;
      local_88[8] = 0x34;
      local_88[9] = 0xf;
      local_88[10] = 0x77;
      local_88[11] = 0x62;
      local_88[12] = 0x48;
      local_88[13] = 0x27;
      local_88[14] = 0x75;
      local_88[15] = 8;
      local_88[16] = 0x56;
      local_88[17] = 0x6a;
      local_88[18] = 0x68;
      local_88[19] = 0x4e;
      local_88[20] = 0x68;
      for (local_94 = 0; local_94 < 0x15; local_94 = local_94 + 1)
      {
        if ((int)(char)(abStack_28[local_94] ^ *(byte *)((long)local_94 + *(long *)(param_2 + 8)))
            != local_88[local_94])
        {
          my_puts("Wrong flag");
          uVar1 = 1;
          goto LAB_00101355;
        }
      }
      my_printf("You found a flag! %s\n", *(undefined8 *)(param_2 + 8));
      uVar1 = 0;
    }
    else
    {
      my_puts("Wrong flag");
      uVar1 = 1;
    }
  }
LAB_00101355:
  if (local_10 != *(long *)(in_FS_OFFSET + 0x28))
  {
    __stack_chk_fail();
  }
  return uVar1;
}

void __libc_csu_init(EVP_PKEY_CTX *param_1, undefined8 param_2, undefined8 param_3)
{
  long lVar1;
  _init(param_1);
  lVar1 = 0;
  do
  {
    (*(code *)(&__DT_INIT_ARRAY)[lVar1])((ulong)param_1 & 0xffffffff, param_2, param_3);
    lVar1 = lVar1 + 1;
  } while (lVar1 != 1);
  return;
}

void __libc_csu_fini(void)
{
  return;
}

void _fini(void)
{
  return;
}
